<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>Tomcat综述 | ZDK&#39;s blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Tomcat">
    <meta name="description" content="Tomcat综述                                                                                                            Web容器 HTTP服务器（比如Apache、Nginx）向浏览器返回静态HTML，浏览器负责解析HTML，将结果呈现给用户。我们希望通过一些交互操作，来获取动态结果，">
<meta name="keywords" content="Tomcat">
<meta property="og:type" content="article">
<meta property="og:title" content="Tomcat综述">
<meta property="og:url" content="https://github.com/zdkswd/2019/07/14/Tomcat综述/index.html">
<meta property="og:site_name" content="ZDK&#39;s blog">
<meta property="og:description" content="Tomcat综述                                                                                                            Web容器 HTTP服务器（比如Apache、Nginx）向浏览器返回静态HTML，浏览器负责解析HTML，将结果呈现给用户。我们希望通过一些交互操作，来获取动态结果，">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://github.com/img/media/tomcat1/1.png">
<meta property="og:image" content="https://github.com/img/media/tomcat1/2.png">
<meta property="og:image" content="https://github.com/img/media/tomcat1/3.png">
<meta property="og:image" content="https://github.com/img/media/tomcat1/4.png">
<meta property="og:image" content="https://github.com/img/media/tomcat1/5.png">
<meta property="og:image" content="https://github.com/img/media/tomcat1/6.png">
<meta property="og:image" content="https://github.com/img/media/tomcat1/7.png">
<meta property="og:image" content="https://github.com/img/media/tomcat1/8.png">
<meta property="og:image" content="https://github.com/img/media/tomcat1/9.png">
<meta property="og:image" content="https://github.com/img/media/tomcat1/8.png">
<meta property="og:image" content="https://zdkswd.github.io/img/media/Spring%20Boot%E5%AE%9E%E6%88%98%20%E5%85%A5%E9%97%A8/191992114-5b5c838544f7c_articlex.png">
<meta property="og:updated_time" content="2019-07-14T02:58:01.465Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Tomcat综述">
<meta name="twitter:description" content="Tomcat综述                                                                                                            Web容器 HTTP服务器（比如Apache、Nginx）向浏览器返回静态HTML，浏览器负责解析HTML，将结果呈现给用户。我们希望通过一些交互操作，来获取动态结果，">
<meta name="twitter:image" content="https://github.com/img/media/tomcat1/1.png">
    
        <link rel="alternate" type="application/atom+xml" title="ZDK&#39;s blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/tmg.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">ZDK</h5>
          <a href="mailto:2822464407@qq.com" title="2822464407@qq.com" class="mail">2822464407@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/zdkswd" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Tomcat综述</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Tomcat综述</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-07-14T02:52:32.000Z" itemprop="datePublished" class="page-time">
  2019-07-14
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/知识总结/">知识总结</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Tomcat综述"><span class="post-toc-number">1.</span> <span class="post-toc-text">Tomcat综述</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#HTTP相关"><span class="post-toc-number">2.</span> <span class="post-toc-text">HTTP相关</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#HTTP本质"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">HTTP本质</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#HTTP请求响应"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">HTTP请求响应</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Cookie和Session"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">Cookie和Session</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Cookie"><span class="post-toc-number">2.3.1.</span> <span class="post-toc-text">Cookie</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Session"><span class="post-toc-number">2.3.2.</span> <span class="post-toc-text">Session</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Session创建与存储"><span class="post-toc-number">2.3.3.</span> <span class="post-toc-text">Session创建与存储</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Servlet规范与容器"><span class="post-toc-number">3.</span> <span class="post-toc-text">Servlet规范与容器</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Servlet接口"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">Servlet接口</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Servlet容器"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">Servlet容器</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#工作流程"><span class="post-toc-number">3.2.1.</span> <span class="post-toc-text">工作流程</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Web应用"><span class="post-toc-number">3.2.2.</span> <span class="post-toc-text">Web应用</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#扩展机制"><span class="post-toc-number">3.2.3.</span> <span class="post-toc-text">扩展机制</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Servlet容器与Spring容器"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">Servlet容器与Spring容器</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Tomcat目录与webapp项目目录"><span class="post-toc-number">4.</span> <span class="post-toc-text">Tomcat目录与webapp项目目录</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Tomcat目录结构"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">Tomcat目录结构</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Tomcat安装目录下的logs目录"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">Tomcat安装目录下的logs目录</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#文件结构"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">文件结构</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-Tomcat综述"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Tomcat综述</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-07-14 10:52:32" datetime="2019-07-14T02:52:32.000Z"  itemprop="datePublished">2019-07-14</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/知识总结/">知识总结</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="Tomcat综述"><a href="#Tomcat综述" class="headerlink" title="Tomcat综述"></a>Tomcat综述</h1><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/img/media/tomcat1/1.png" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<hr>
<p><strong>Web容器</strong></p>
<p>HTTP服务器（比如Apache、Nginx）向浏览器返回静态HTML，浏览器负责解析HTML，将结果呈现给用户。我们希望通过一些交互操作，来获取动态结果，需要一些扩展机制能够让HTTP服务器调用服务端程序。于是Sun公司推出了<strong>Servlet</strong>技术。可以把Servlet简单理解为运行在服务端的Java小程序，Servlet没有main方法，不能独立运行，所以必须把它部署到Servlet容器中，由容器来实例化并调用Servlet。</p>
<p>Tomcat和Jetty就是一个Servlet容器。为了方便使用，它们也具有HTTP服务器的功能，因此<strong>Tomcat或者Jetty就是一个“HTTP服务器 + Servlet容器”，我们也叫它们Web容器。</strong>Tomcat和Jetty算是一个轻量级的应用服务器。</p>
<p><strong>Tomcat是Spring Boot默认的嵌入式Servlet容器。</strong>最新版本Tomcat和Jetty都支持Servlet 4.0规范。</p>
<h1 id="HTTP相关"><a href="#HTTP相关" class="headerlink" title="HTTP相关"></a>HTTP相关</h1><h2 id="HTTP本质"><a href="#HTTP本质" class="headerlink" title="HTTP本质"></a>HTTP本质</h2><p>HTTP协议是浏览器与服务器之间的数据传送协议。作为应用层协议，HTTP是基于TCP/IP协议来传递数据的（HTML文件、图片、查询结果等），HTTP协议不涉及数据包（Packet）传输，主要规定了客户端和服务器之间的通信格式。<strong>HTTP协议的本质就是一种浏览器与服务器之间约定好的通信格式</strong>。</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/img/media/tomcat1/2.png" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p>HTTP通信机制是在一次完整的HTTP通信过程中，Web浏览器与Web服务器之间将完成的步骤： </p>
<ol>
<li><strong>域名解析</strong></li>
<li><strong>发起TCP的3次握手</strong> </li>
<li><strong>Web浏览器向Web服务器发送http请求命令</strong> 。例如，GET/sample/hello.jsp HTTP/1.1。</li>
<li><strong>Web浏览器发送http请求头信息</strong> ，浏览器发送其请求命令之后，还要以头信息的形式向Web服务器发送一些别的信息，之后浏览器发送了一空白行来通知服务器，它已经结束了该头信息的发送。 </li>
<li><strong>Web服务器应答</strong> ，客户机向服务器发出请求后，服务器会客户机回送应答， HTTP/1.1 200 OK ，应答的第一部分是协议的版本号和应答状态码。</li>
<li><strong>Web服务器发送应答头信息</strong> ，服务器也会随同应答向用户发送关于它自己的数据及被请求的文档。 </li>
<li><strong>Web服务器向浏览器发送数据</strong> ，Web服务器向浏览器发送头信息后，它会发送一个空白行来表示头信息的发送到此为结束，接着，就以Content-Type应答头信息所描述的格式发送用户所请求的实际数据。</li>
<li><strong>Web服务器关闭TCP连接</strong> ，一般情况下，一旦Web服务器向浏览器发送了请求数据，它就要关闭TCP连接，然后如果浏览器或者服务器在其头信息加入了这行代码：Connection:keep-alive ，TCP连接在发送后将仍然保持打开状态，于是，浏览器可以继续通过相同的连接发送请求。保持连接节省了为每个请求建立新连接所需的时间，还节约了网络带宽。</li>
</ol>
<h2 id="HTTP请求响应"><a href="#HTTP请求响应" class="headerlink" title="HTTP请求响应"></a>HTTP请求响应</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/img/media/tomcat1/3.png" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p>HTTP请求数据由三部分组成，分别是<strong>请求行、请求报头、请求正文</strong>。当这个HTTP请求数据到达Tomcat后，Tomcat会把HTTP请求数据字节流解析成一个Request对象，这个Request对象封装了HTTP所有的请求信息。接着Tomcat把这个Request对象交给Web应用去处理，处理完后得到一个Response对象，Tomcat会把这个Response对象转成HTTP格式的响应数据并发送给浏览器。</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/img/media/tomcat1/4.png" alt="4" title="">
                </div>
                <div class="image-caption">4</div>
            </figure>
<p>HTTP的响应也是由三部分组成，分别是<strong>状态行、响应报头、报文主体</strong>。</p>
<h2 id="Cookie和Session"><a href="#Cookie和Session" class="headerlink" title="Cookie和Session"></a>Cookie和Session</h2><h3 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h3><p>Cookie是HTTP报文的一个请求头，Web应用可以将用户的标识信息或者其他一些信息（用户名等）存储在Cookie中。用户经过验证之后，每次HTTP请求报文中都包含Cookie，这样服务器读取这个Cookie请求头就知道用户是谁了。<strong>Cookie本质上就是一份存储在用户本地的文件，里面包含了每次请求中都需要传递的信息</strong>。</p>
<h3 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h3><p>Cookie以明文的方式存储在本地，而Cookie中往往带有用户信息，这样就造成了非常大的安全隐患。而Session的出现解决了这个问题，<strong>Session可以理解为服务器端开辟的存储空间，里面保存了用户的状态</strong>，用户信息以Session的形式存储在服务端。当用户请求到来时，服务端可以把用户的请求和用户的Session对应起来。通过Cookie来将Session和请求对应起来。浏览器在Cookie中填充了一个Session ID之类的字段用来标识请求。</p>
<h3 id="Session创建与存储"><a href="#Session创建与存储" class="headerlink" title="Session创建与存储"></a>Session创建与存储</h3><p>Java中，Web应用程序在调用HttpServletRequest的getSession方法时，由Web容器（比如Tomcat）创建的。</p>
<p>Tomcat的Session管理器提供了多种持久化方案来存储Session，通常会采用高性能的存储方式，比如Redis，并且通过集群部署的方式，防止单点故障，从而提升高可用。同时，Session有过期时间，因此Tomcat会开启后台线程定期的轮询，如果Session过期了就将Session失效。</p>
<h1 id="Servlet规范与容器"><a href="#Servlet规范与容器" class="headerlink" title="Servlet规范与容器"></a>Servlet规范与容器</h1><p>Servlet接口其实是<strong>Servlet容器跟具体业务类之间的接口</strong>。</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/img/media/tomcat1/5.png" alt="5" title="">
                </div>
                <div class="image-caption">5</div>
            </figure>
<p>HTTP服务器不直接调用业务类，而是把请求交给容器来处理，容器通过Servlet接口调用业务类。因此Servlet接口和Servlet容器的出现，达到了HTTP服务器与业务类解耦的目的。</p>
<p>Servlet接口和Servlet容器这一整套规范叫作<strong>Servlet规范</strong>。Tomcat和Jetty都按照Servlet规范的要求实现了Servlet容器，同时它们也具有HTTP服务器的功能。作为Java程序员，如果要实现新的业务功能，只需要实现一个Servlet，并把它注册到Tomcat（Servlet容器）中，剩下的事情就由Tomcat处理了。</p>
<h2 id="Servlet接口"><a href="#Servlet接口" class="headerlink" title="Servlet接口"></a>Servlet接口</h2><p>Servlet接口定义了下面五个方法：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/img/media/tomcat1/6.png" alt="6" title="">
                </div>
                <div class="image-caption">6</div>
            </figure>
<p>其中最重要是的<strong>service</strong>方法，具体业务类在这个方法里实现处理逻辑。这个方法有两个参数：<strong>ServletRequest</strong>和<strong>ServletResponse</strong>。ServletRequest用来封装请求信息，ServletResponse用来封装响应信息，因此<strong>本质上这两个类是对通信协议的封装。</strong></p>
<p>比如HTTP协议中的请求和响应就是对应了<strong>HttpServletRequest</strong>和<strong>HttpServletResponse</strong>这两个类。可以通过<strong>HttpServletRequest</strong>来获取所有请求相关的信息，包括请求路径、Cookie、HTTP头、请求参数等。此外，还可以通过HttpServletRequest来创建和获取Session。而HttpServletResponse是用来封装HTTP响应的。</p>
<p>可以看到接口中还有两个跟生命周期有关的方法<strong>init</strong>和<strong>destroy</strong>，这是一个比较贴心的设计，Servlet容器在加载Servlet类的时候会调用init方法，在卸载的时候会调用destroy方法。可能会在init方法里初始化一些资源，并在destroy方法里释放这些资源，比如Spring MVC中的DispatcherServlet，就是在init方法里创建了自己的Spring容器。</p>
<p><strong>ServletConfig</strong>的作用就是封装Servlet的初始化参数。可以在web.xml给Servlet配置参数，并在程序里通过<strong>getServletConfig</strong>方法拿到这些参数。</p>
<p>有接口一般就有<strong>抽象类</strong>，抽象类用来实现接口和封装通用的逻辑，因此Servlet规范提供了GenericServlet抽象类，可以通过扩展它来实现Servlet。虽然Servlet规范并不在乎通信协议是什么，但是大多数的Servlet都是在HTTP环境中处理的，因此Servet规范还提供了HttpServlet来继承GenericServlet，并且加入了HTTP特性。这样通过继承HttpServlet类来实现自己的Servlet，只需要重写两个方法：<strong>doGet</strong>和<strong>doPost</strong>。</p>
<h2 id="Servlet容器"><a href="#Servlet容器" class="headerlink" title="Servlet容器"></a>Servlet容器</h2><h3 id="工作流程"><a href="#工作流程" class="headerlink" title="工作流程"></a>工作流程</h3><p>当客户请求某个资源时，HTTP服务器会用一个ServletRequest对象把客户的请求信息封装起来，然后调用Servlet容器的service方法，Servlet容器拿到请求后，根据请求的URL和Servlet的映射关系，找到相应的Servlet，如果Servlet还没有被加载，就用反射机制创建这个Servlet，并调用Servlet的init方法来完成初始化，接着调用Servlet的service方法来处理请求，把ServletResponse对象返回给HTTP服务器，HTTP服务器会把响应发送给客户端。</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/img/media/tomcat1/7.png" alt="7" title="">
                </div>
                <div class="image-caption">7</div>
            </figure>
<h3 id="Web应用"><a href="#Web应用" class="headerlink" title="Web应用"></a>Web应用</h3><p>一般来说，以Web应用程序的方式来部署Servlet的。根据Servlet规范，Web应用程序有一定的目录结构，在这个目录下分别放置了Servlet的类文件、配置文件以及静态资源，<strong>Servlet容器通过读取配置文件</strong>，就能找到并加载Servlet。Web应用的目录结构大概是下面这样的：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/img/media/tomcat1/8.png" alt="8" title="">
                </div>
                <div class="image-caption">8</div>
            </figure>
<p>Servlet规范里定义了<strong>ServletContext</strong>这个接口来对应一个Web应用。Web应用部署好后，Servlet容器在启动时会加载Web应用，并为每个Web应用创建唯一的ServletContext对象。</p>
<p>一个Web应用可能有多个Servlet，这些Servlet可以通过全局的ServletContext来共享数据，这些数据包括Web应用的初始化参数、Web应用目录下的文件资源等。由于ServletContext持有所有Servlet实例，还可以通过它来实现Servlet请求的转发。</p>
<h3 id="扩展机制"><a href="#扩展机制" class="headerlink" title="扩展机制"></a>扩展机制</h3><p>设计一个规范或者一个中间件，要充分考虑到可扩展性。Servlet规范提供了两种扩展机制：<strong>Filter</strong>和<strong>Listener</strong>。</p>
<p><strong>Filter</strong>是过滤器，这个接口允许对<strong>请求和响应</strong>做一些统一的定制化处理，比如可以根据请求的频率来限制访问，或者根据国家地区的不同来修改响应内容。过滤器的<strong>工作原理</strong>是这样的：Web应用部署完成后，Servlet容器需要实例化Filter并把Filter链接成一个FilterChain。当请求进来时，获取第一个Filter并调用doFilter方法，doFilter方法负责调用这个FilterChain中的下一个Filter。</p>
<p><strong>Listener</strong>是监听器，是另一种扩展机制。当Web应用在Servlet容器中运行时，Servlet容器内部会不断的发生各种事件，如Web应用的启动和停止、用户请求到达等。 Servlet容器提供了一些默认的监听器来监听这些事件，当事件发生时，Servlet容器会负责调用监听器的方法。当然，可以定义自己的监听器去监听感兴趣的事件，将监听器配置在web.xml中。比如<strong>Spring就实现了自己的监听器，来监听ServletContext的启动事件，目的是当Servlet容器启动时，创建并初始化全局的Spring容器。</strong></p>
<h2 id="Servlet容器与Spring容器"><a href="#Servlet容器与Spring容器" class="headerlink" title="Servlet容器与Spring容器"></a>Servlet容器与Spring容器</h2><p> Tomcat&amp;Jetty在启动时给每个Web应用创建一个全局的上下文环境，这个上下文就是<strong>ServletContext</strong>，其为后面的Spring容器提供宿主环境。</p>
<p>Tomcat&amp;Jetty在启动过程中触发容器初始化事件，Spring的ContextLoaderListener会监听到这个事件，它的contextInitialized方法会被调用，在这个方法中，Spring会初始化全局的Spring根容器，这个就是Spring的IoC容器，IoC容器初始化完毕后，Spring将其存储到ServletContext中，便于以后来获取。</p>
<p>Tomcat&amp;Jetty在启动过程中还会扫描Servlet，一个Web应用中的Servlet可以有多个，以SpringMVC中的DispatcherServlet为例，这个Servlet实际上是一个标准的前端控制器，用以转发、匹配、处理每个Servlet请求。</p>
<p>Servlet一般会延迟加载，当第一个请求达到时，Tomcat&amp;Jetty发现DispatcherServlet还没有被实例化，就调用DispatcherServlet的init方法，DispatcherServlet在初始化的时候会建立自己的容器，叫做SpringMVC 容器，用来持有Spring MVC相关的Bean。同时，Spring MVC还会通过ServletContext拿到Spring根容器，并将Spring根容器设为SpringMVC容器的父容器，请注意，Spring MVC容器可以访问父容器中的Bean，但是父容器不能访问子容器的Bean， 也就是说Spring根容器不能访问SpringMVC容器里的Bean。说的通俗点就是，在Controller里可以访问Service对象，但是在Service里不可以访问Controller对象。  </p>
<h1 id="Tomcat目录与webapp项目目录"><a href="#Tomcat目录与webapp项目目录" class="headerlink" title="Tomcat目录与webapp项目目录"></a>Tomcat目录与webapp项目目录</h1><h2 id="Tomcat目录结构"><a href="#Tomcat目录结构" class="headerlink" title="Tomcat目录结构"></a>Tomcat目录结构</h2><p>/bin：存放Windows或Linux平台上启动和关闭Tomcat的脚本文件。<br>/conf：存放Tomcat的各种全局配置文件，其中最重要的是server.xml。<br>/lib：存放Tomcat以及所有Web应用都可以访问的JAR文件。<br>/logs：存放Tomcat执行时产生的日志文件。<br>/work：存放JSP编译后产生的Class文件。<br>/webapps：Tomcat的Web应用目录，默认情况下把Web应用放在这个目录下。</p>
<h2 id="Tomcat安装目录下的logs目录"><a href="#Tomcat安装目录下的logs目录" class="headerlink" title="Tomcat安装目录下的logs目录"></a>Tomcat安装目录下的logs目录</h2><ul>
<li><code>catalina.***.log</code></li>
</ul>
<p>主要是记录Tomcat启动过程的信息，在这个文件可以看到启动的JVM参数以及操作系统等日志信息。</p>
<ul>
<li><code>catalina.out</code></li>
</ul>
<p>catalina.out是Tomcat的标准输出（stdout）和标准错误（stderr），这是在Tomcat的启动脚本里指定的，如果没有修改的话stdout和stderr会重定向到这里。</p>
<ul>
<li><code>localhost.**.log</code></li>
</ul>
<p>主要记录Web应用在初始化过程中遇到的未处理的异常，会被Tomcat捕获而输出这个日志文件。</p>
<ul>
<li><code>localhost_access_log.**.txt</code></li>
</ul>
<p>存放访问Tomcat的请求日志，包括IP地址以及请求的路径、时间、请求协议以及状态码等信息。</p>
<ul>
<li><code>manager.***.log/host-manager.***.log</code></li>
</ul>
<p>存放Tomcat自带的manager项目的日志信息。</p>
<h2 id="文件结构"><a href="#文件结构" class="headerlink" title="文件结构"></a>文件结构</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/img/media/tomcat1/9.png" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/img/media/tomcat1/8.png" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://zdkswd.github.io/img/media/Spring%20Boot%E5%AE%9E%E6%88%98%20%E5%85%A5%E9%97%A8/191992114-5b5c838544f7c_articlex.png" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2019-07-14T02:58:01.465Z" itemprop="dateUpdated">2019-07-14 10:58:01</time>
</span><br>


        
    </div>
    
    <footer>
        <a href="https://github.com/zdkswd">
            <img src="/img/tmg.jpg" alt="ZDK">
            ZDK
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Tomcat/">Tomcat</a></li></ul>


            


        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between flex-row-reverse">
  

  
    <div class="waves-block waves-effect next">
      <a href="/2019/07/09/大数据综述/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Hadoop综述</h4>
      </a>
    </div>
  
</nav>



    











    <!-- Valine Comments -->
    <div class="comments vcomment" id="comments"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script>
    <!-- Valine Comments script -->
    <script>
        var GUEST_INFO = ['nick','mail','link'];
        var guest_info = 'nick,mail,link'.split(',').filter(function(item){
          return GUEST_INFO.indexOf(item) > -1
        });
        new Valine({
            el: '#comments',
            notify: 'true' == 'true',
            verify: 'false' == 'true',
            appId: "QiU7UFIdgTTauFTk89N47mQS-gzGzoHsz",
            appKey: "gkBx5soQkBREmER84PWbNJeM",
            avatar: "mm",
            placeholder: "ヾﾉ≧∀≦)o来啊，快活啊!",
            guest_info: guest_info.length == 0 ? GUEST_INFO : guest_info,
            pageSize: "10"
        })
    </script>
    <!-- Valine Comments end -->







</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循 <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p><span>ZDK &copy; 2015 - 2019</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
    <span id="busuanzi_container_site_uv">
        本站访客数<span id="busuanzi_value_site_uv"></span>人次
      </span>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
    </script>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>


    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: false, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>



<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" async></script>




<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = 'zdk'blog';
            clearTimeout(titleTime);
        } else {
            document.title = '';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
